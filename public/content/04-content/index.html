<!DOCTYPE html>
<html lang="en-us" 
      xmlns:og="http://ogp.me/ns#" 
      xmlns:fb="https://www.facebook.com/2008/fbml">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Ben Bushong">

  
  
  
    
  
  <meta name="description" content="Readings Guiding Questions Data visualization principles  Encoding data using visual cues Avoid Psuedo-3D Plots Avoid too many significant digits Know your audience Know when to include 0 Do not distort quantities Order categories by a meaningful value Show the data Faceting  Use common axes with facets Align plots vertically to see horizontal changes and horizontally to see vertical changes Facet grids Visual cues to be compared should be adjacent, continued Use color  Think of the color blind  Using a discrete color palette Using a continuous color palette  gridExtra and grid.">

  
  <link rel="alternate" hreflang="en-us" href="https://ssc442.netlify.app/content/04-content/">

  


  
  
  
  <meta name="theme-color" content="#18453B">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans+Condensed:400,400i,700,700i%7COverpass:400,400i,700,700i&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu5cb5fae69b6b75ece00896ca20e5499a_29457_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu5cb5fae69b6b75ece00896ca20e5499a_29457_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://ssc442.netlify.app/content/04-content/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Data Analytics">
  <meta property="og:url" content="https://ssc442.netlify.app/content/04-content/">
  <meta property="og:title" content="Visualizations in Practice | Data Analytics">
  <meta property="og:description" content="Readings Guiding Questions Data visualization principles  Encoding data using visual cues Avoid Psuedo-3D Plots Avoid too many significant digits Know your audience Know when to include 0 Do not distort quantities Order categories by a meaningful value Show the data Faceting  Use common axes with facets Align plots vertically to see horizontal changes and horizontally to see vertical changes Facet grids Visual cues to be compared should be adjacent, continued Use color  Think of the color blind  Using a discrete color palette Using a continuous color palette  gridExtra and grid."><meta property="og:image" content="https://ssc442.netlify.app/img/social-image.png">
  <meta property="twitter:image" content="https://ssc442.netlify.app/img/social-image.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-09-21T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-11-02T11:41:59-04:00">
  

  



  


  


  <link rel="shortcut icon" href="https://ssc442.netlify.app/favicon.ico" />
  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://ssc442.netlify.app/img/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://ssc442.netlify.app/img/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://ssc442.netlify.app/img/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://ssc442.netlify.app/img/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://ssc442.netlify.app/img/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://ssc442.netlify.app/img/apple-touch-icon-152x152.png" />
  <link rel="icon" type="image/png" href="https://ssc442.netlify.app/img/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="https://ssc442.netlify.app/img/favicon-16x16.png" sizes="16x16" />
  <meta name="application-name" content="SSC 442: Data Analytics" />
  <meta name="msapplication-TileColor" content="#FFFFFF" />
  <meta name="msapplication-TileImage" content="https://ssc442.netlify.app/img/mstile-144x144.png" />


  <title>Visualizations in Practice | Data Analytics</title>

</head>


<body id="top" data-spy="scroll" data-offset="70"
    data-target="#TableOfContents"
    >

    <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


    







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Data Analytics</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Data Analytics</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/syllabus/"><span>Syllabus</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/schedule/"><span>Schedule</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/content/"><span>Content</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/example/"><span>Examples</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/assignment/"><span>Assignments</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://join.slack.com/t/ssc442/shared_invite/zt-v3n7r8hh-TjwMzpDLBSywvVYwzftqXA" target="_blank" rel="noopener"><span><i class="fab fa-slack"></i></span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      

      

      

    </ul>

  </div>
</nav>


    

<div class="container-fluid docs">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
            





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/content/">Readings, lectures, and videos</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/content/10-content/">Course content</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/content/10-content/">10: Nonparametric Regression</a>
      </li>
      
      <li >
        <a href="/content/01-content/">1: Introduction to R</a>
      </li>
      
      <li >
        <a href="/content/02-content/">2: The Tidyverse</a>
      </li>
      
      <li >
        <a href="/content/03-content/">3: Visualizations I</a>
      </li>
      
      <li class="active">
        <a href="/content/04-content/">4: Visualizations III</a>
      </li>
      
      <li >
        <a href="/content/05-content/">5: Uncertainty</a>
      </li>
      
      <li >
        <a href="/content/06-content/">6: Linear Regression I</a>
      </li>
      
      <li >
        <a href="/content/07-content/">7: Linear Regression II</a>
      </li>
      
      <li >
        <a href="/content/08-content/">8: Linear Regression III</a>
      </li>
      
      <li >
        <a href="/content/09-content/">9: Bias vs. Variance</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

        </div>

        

        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

            <article class="article">

                <div class="docs-article-container">
                    <h1>Visualizations in Practice</h1>

                    

                    
                    <div class="due-date p-2 mb-3 bg-content text-white">
                        Content for Tuesday, September 21, 2021
                    </div>
                    

                    

                    <div class="article-style">
                        
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>
<link href="/rmarkdown-libs/lightable/lightable.css" rel="stylesheet" />

<div id="TOC">
<ul>
<li><a href="#readings">Readings</a></li>
<li><a href="#guiding-questions">Guiding Questions</a></li>
<li><a href="#data-visualization-principles">Data visualization principles</a>
<ul>
<li><a href="#encoding-data-using-visual-cues">Encoding data using visual cues</a></li>
<li><a href="#avoid-psuedo-3d-plots">Avoid Psuedo-3D Plots</a></li>
<li><a href="#avoid-too-many-significant-digits">Avoid too many significant digits</a></li>
<li><a href="#know-your-audience">Know your audience</a></li>
<li><a href="#know-when-to-include-0">Know when to include 0</a></li>
<li><a href="#do-not-distort-quantities">Do not distort quantities</a></li>
<li><a href="#order-categories-by-a-meaningful-value">Order categories by a meaningful value</a></li>
<li><a href="#show-the-data">Show the data</a></li>
<li><a href="#faceting">Faceting</a>
<ul>
<li><a href="#use-common-axes-with-facets">Use common axes with facets</a></li>
<li><a href="#align-plots-vertically-to-see-horizontal-changes-and-horizontally-to-see-vertical-changes">Align plots vertically to see horizontal changes and horizontally to see vertical changes</a></li>
<li><a href="#facet-grids">Facet grids</a></li>
<li><a href="#visual-cues-to-be-compared-should-be-adjacent-continued">Visual cues to be compared should be adjacent, continued</a></li>
<li><a href="#use-color">Use color</a></li>
</ul></li>
<li><a href="#think-of-the-color-blind">Think of the color blind</a>
<ul>
<li><a href="#using-a-discrete-color-palette">Using a discrete color palette</a></li>
<li><a href="#using-a-continuous-color-palette">Using a continuous color palette</a></li>
</ul></li>
<li><a href="#gridextra-and-grid.arrange">gridExtra and <code>grid.arrange</code></a></li>
</ul></li>
</ul>
</div>

<div id="readings" class="section level3">
<h3>Readings</h3>
<ul>
<li>This page.</li>
</ul>
</div>
<div id="guiding-questions" class="section level3">
<h3>Guiding Questions</h3>
<ul>
<li>Why do we create visualizations? What types of data are best suited for visuals?</li>
<li>How do we best visualize the variability in our data?</li>
<li>What makes a visual compelling?</li>
<li>What are the worst visuals? Which of these are most frequently used? Why?</li>
</ul>
<p>As with last week’s content, the technical aspects of this lecture will be explored in greater detail in the Thursday practical lecture. Today, we will focus on some principles.</p>
<blockquote>
<p>“The greatest value of a picture is when it forces us to notice what we never expected to see.” – John Tukey</p>
</blockquote>
</div>
<div id="data-visualization-principles" class="section level1">
<h1>Data visualization principles</h1>
<p>We have already provided some rules to follow as we created plots for our examples. Here, we aim to provide some general principles we can use as a guide for effective data visualization. Much of this section is based on a talk by Karl Broman<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> titled “Creating Effective Figures and Tables”<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> and includes some of the figures which were made with code that Karl makes available on his GitHub repository<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>, as well as class notes from Peter Aldhous’ Introduction to Data Visualization course<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. Following Karl’s approach, we show some examples of plot styles we should avoid, explain how to improve them, and use these as motivation for a list of principles. We compare and contrast plots that follow these principles to those that don’t.</p>
<p>The principles are mostly based on research related to how humans detect patterns and make visual comparisons. The preferred approaches are those that best fit the way our brains process visual information. When deciding on a visualization approach, it is also important to keep our goal in mind. We may be comparing a viewable number of quantities, describing distributions for categories or numeric values, comparing the data from two groups, or describing the relationship between two variables. As a final note, we want to emphasize that for a data scientist it is important to adapt and optimize graphs to the audience. For example, an exploratory plot made for ourselves will be different than a chart intended to communicate a finding to a general audience.</p>
<p>As with the discussion above, we will be using these libraries—note the addition of <strong>gridExtra</strong>:</p>
<pre class="r"><code>library(tidyverse)
library(dslabs)
library(gridExtra)</code></pre>
<div id="encoding-data-using-visual-cues" class="section level3">
<h3>Encoding data using visual cues</h3>
<p>We start by describing some principles for encoding data. There are several approaches at our disposal including position, aligned lengths, angles, area, brightness, and color hue.</p>
<p>To illustrate how some of these strategies compare, let’s suppose we want to report the results from two hypothetical polls regarding browser preference taken in 2000 and then 2015. For each year, we are simply comparing five quantities – the five percentages. A widely used graphical representation of percentages, popularized by Microsoft Excel, is the pie chart:</p>
<p><img src="/content/04-content_files/figure-html/piechart-1.png" width="672" /></p>
<p>Here we are representing quantities with both areas and angles, since both the angle and area of each pie slice are proportional to the quantity the slice represents. This turns out to be a sub-optimal choice since, as demonstrated by perception studies, humans are not good at precisely quantifying angles and are even worse when area is the only available visual cue. The donut chart is an example of a plot that uses only area:</p>
<p><img src="/content/04-content_files/figure-html/donutchart-1.png" width="672" /></p>
<p>To see how hard it is to quantify angles and area, note that the rankings and all the percentages in the plots above changed from 2000 to 2015. Can you determine the actual percentages and rank the browsers’ popularity? Can you see how the percentages changed from 2000 to 2015? It is not easy to tell from the plot. In fact, the <code>pie</code> R function help file states that:</p>
<blockquote>
<p>Pie charts are a very bad way of displaying information. The eye is good at judging linear measures and bad at judging relative areas. A bar chart or dot chart is a preferable way of displaying this type of data.</p>
</blockquote>
<p>In this case, simply showing the numbers is not only clearer, but would also save on printing costs if printing a paper copy:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Browser
</th>
<th style="text-align:right;">
2000
</th>
<th style="text-align:right;">
2015
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Opera
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Safari
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
22
</td>
</tr>
<tr>
<td style="text-align:left;">
Firefox
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:left;">
Chrome
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
IE
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
27
</td>
</tr>
</tbody>
</table>
<p>The preferred way to plot these quantities is to use length and position as visual cues, since humans are much better at judging linear measures. The barplot uses this approach by using bars of length proportional to the quantities of interest. By adding horizontal lines at strategically chosen values, in this case at every multiple of 10, we ease the visual burden of quantifying through the position of the top of the bars. Compare and contrast the information we can extract from the two figures.</p>
<p><img src="/content/04-content_files/figure-html/two-barplots-1.png" width="100%" /></p>
<p>Notice how much easier it is to see the differences in the barplot. In fact, we can now determine the actual percentages by following a horizontal line to the x-axis.</p>
<p>If for some reason you need to make a pie chart, label each pie slice with its respective percentage so viewers do not have to infer them from the angles or area:</p>
<p><img src="/content/04-content_files/figure-html/excel-barplot-1.png" width="672" /></p>
<p>In general, when displaying quantities, position and length are preferred over angles and/or area. Brightness and color are even harder to quantify than angles. But, as we will see later, they are sometimes useful when more than two dimensions must be displayed at once.</p>
</div>
<div id="avoid-psuedo-3d-plots" class="section level3">
<h3>Avoid Psuedo-3D Plots</h3>
<p>The figure below, taken from the scientific literature<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>,
shows three variables: dose, drug type and survival. Although your screen/book page is flat and two-dimensional, the plot tries to imitate three dimensions and assigned a dimension to each variable.</p>
<p><img src="/content/04-content_files/fig8b.png" /></p>
<p>(Image courtesy of Karl Broman)</p>
<p>Humans are not good at seeing in three dimensions (which explains why it is hard to parallel park) and our limitation is even worse with regard to pseudo-three-dimensions. To see this, try to determine the values of the survival variable in the plot above. Can you tell when the purple ribbon intersects the red one? This is an example in which we can easily use color to represent the categorical variable instead of using a pseudo-3D:</p>
<pre class="r"><code>##First read data
url &lt;- &quot;https://github.com/kbroman/Talk_Graphs/raw/master/R/fig8dat.csv&quot;
dat &lt;- read.csv(url)

##Now make alternative plot
dat %&gt;% gather(drug, survival, -log.dose) %&gt;%
  mutate(drug = gsub(&quot;Drug.&quot;,&quot;&quot;,drug)) %&gt;%
  ggplot(aes(log.dose, survival, color = drug)) +
  geom_line()</code></pre>
<p><img src="/content/04-content_files/figure-html/colors-for-different-lines-1.png" width="672" /></p>
<p>Notice how much easier it is to determine the survival values.</p>
<p>Pseudo-3D is sometimes used completely gratuitously: plots are made to look 3D even when the 3rd dimension does not represent a quantity. This only adds confusion and makes it harder to relay your message. Here are two examples:</p>
<p><img src="/content/04-content_files/fig1e.png" />
<img src="/content/04-content_files/fig2d.png" /></p>
<p>(Images courtesy of Karl Broman)</p>
</div>
<div id="avoid-too-many-significant-digits" class="section level3">
<h3>Avoid too many significant digits</h3>
<p>By default, statistical software like R returns many significant digits. The default behavior in R is to show 7 significant digits. That many digits often adds no information and the added visual clutter can make it hard for the viewer to understand the message. As an example, here are the per 10,000 disease rates, computed from totals and population in R, for California across the five decades:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
state
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
Measles
</th>
<th style="text-align:right;">
Pertussis
</th>
<th style="text-align:right;">
Polio
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
1940
</td>
<td style="text-align:right;">
37.8826320
</td>
<td style="text-align:right;">
18.3397861
</td>
<td style="text-align:right;">
0.8266512
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:right;">
13.9124205
</td>
<td style="text-align:right;">
4.7467350
</td>
<td style="text-align:right;">
1.9742639
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
1960
</td>
<td style="text-align:right;">
14.1386471
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.2640419
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
1970
</td>
<td style="text-align:right;">
0.9767889
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
1980
</td>
<td style="text-align:right;">
0.3743467
</td>
<td style="text-align:right;">
0.0515466
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p>We are reporting precision up to 0.00001 cases per 10,000, a very small value in the context of the changes that are occurring across the dates. In this case, two significant figures is more than enough and clearly makes the point that rates are decreasing:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
state
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
Measles
</th>
<th style="text-align:right;">
Pertussis
</th>
<th style="text-align:right;">
Polio
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
1940
</td>
<td style="text-align:right;">
37.9
</td>
<td style="text-align:right;">
18.3
</td>
<td style="text-align:right;">
0.8
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
1950
</td>
<td style="text-align:right;">
13.9
</td>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
2.0
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
1960
</td>
<td style="text-align:right;">
14.1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.3
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
1970
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
1980
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p>Useful ways to change the number of significant digits or to round numbers are <code>signif</code> and <code>round</code>. You can define the number of significant digits globally by setting options like this: <code>options(digits = 3)</code>.</p>
<p>Another principle related to displaying tables is to place values being compared on columns rather than rows. Note that our table above is easier to read than this one:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
state
</th>
<th style="text-align:left;">
disease
</th>
<th style="text-align:right;">
1940
</th>
<th style="text-align:right;">
1950
</th>
<th style="text-align:right;">
1960
</th>
<th style="text-align:right;">
1970
</th>
<th style="text-align:right;">
1980
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:left;">
Measles
</td>
<td style="text-align:right;">
37.9
</td>
<td style="text-align:right;">
13.9
</td>
<td style="text-align:right;">
14.1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.4
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:left;">
Pertussis
</td>
<td style="text-align:right;">
18.3
</td>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:left;">
Polio
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
</div>
<div id="know-your-audience" class="section level3">
<h3>Know your audience</h3>
<p>Graphs can be used for 1) our own exploratory data analysis, 2) to convey a message to experts, or 3) to help tell a story to a general audience. Make sure that the intended audience understands each element of the plot.</p>
<p>As a simple example, consider that for your own exploration it may be more useful to log-transform data and then plot it. However, for a general audience that is unfamiliar with converting logged values back to the original measurements, using a log-scale for the axis instead of log-transformed values will be much easier to digest.</p>
</div>
<div id="know-when-to-include-0" class="section level3">
<h3>Know when to include 0</h3>
<p>When using barplots, it is misinformative not to start the bars at 0. This is because, by using a barplot, we are implying the length is proportional to the quantities being displayed. By avoiding 0, relatively small differences can be made to look much bigger than they actually are. This approach is often used by politicians or media organizations trying to exaggerate a difference. Below is an illustrative example used by Peter Aldhous in this lecture: <a href="http://paldhous.github.io/ucb/2016/dataviz/week2.html">http://paldhous.github.io/ucb/2016/dataviz/week2.html</a>.</p>
<p><img src="/content/04-content_files/class2_8.jpg" /></p>
<p>(Source: Fox News, via Media Matters<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>.)</p>
<p>From the plot above, it appears that apprehensions have almost tripled when, in fact, they have only increased by about 16%. Starting the graph at 0 illustrates this clearly:</p>
<p><img src="/content/04-content_files/figure-html/barplot-from-zero-1-1.png" width="672" /></p>
<p>Here is another example, described in detail in a Flowing Data blog post:</p>
<p><img src="/content/04-content_files/Bush-cuts.png" /></p>
<p>(Source: Fox News, via Flowing Data<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>.)</p>
<p>This plot makes a 13% increase look like a five fold change. Here is the appropriate plot:</p>
<p><img src="/content/04-content_files/figure-html/barplot-from-zero-2-1.png" width="672" /></p>
<p>Finally, here is an extreme example that makes a very small difference of under 2% look like a 10-100 fold change:</p>
<p><img src="/content/04-content_files/venezuela-election.png" /></p>
<p>(Source:
Venezolana de Televisión via Pakistan Today<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> and Diego Mariano.)</p>
<p>Here is the appropriate plot:</p>
<p><img src="/content/04-content_files/figure-html/barplot-from-zero-3-1.png" width="672" /></p>
<p>When using position rather than length, it is then not necessary to include 0. This is particularly the case when we want to compare differences between groups relative to the within-group variability. Here is an illustrative example showing country average life expectancy stratified across continents in 2012:</p>
<p><img src="/content/04-content_files/figure-html/points-plot-not-from-zero-1.png" width="100%" /></p>
<p>Note that in the plot on the left, which includes 0, the space between 0 and 43 adds no information and makes it harder to compare the between and within group variability.</p>
</div>
<div id="do-not-distort-quantities" class="section level3">
<h3>Do not distort quantities</h3>
<p>During President Barack Obama’s 2011 State of the Union Address, the following chart was used to compare the US GDP to the GDP of four competing nations:</p>
<p><img src="/content/04-content_files/state-of-the-union.png" /></p>
<p>(Source: The 2011 State of the Union Address<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>)</p>
<p>Judging by the area of the circles, the US appears to have an economy over five times larger than China’s and over 30 times larger than France’s. However, if we look at the actual numbers, we see that this is not the case. The actual ratios are 2.6 and 5.8 times bigger than China and France, respectively. The reason for this distortion is that the radius, rather than the area, was made to be proportional to the quantity, which implies that the proportion between the areas is squared: 2.6 turns into 6.5 and 5.8 turns into 34.1. Here is a comparison of the circles we get if we make the value proportional to the radius and to the area:</p>
<pre class="r"><code>gdp &lt;- c(14.6, 5.7, 5.3, 3.3, 2.5)
gdp_data &lt;- data.frame(Country = rep(c(&quot;United States&quot;, &quot;China&quot;, &quot;Japan&quot;, &quot;Germany&quot;, &quot;France&quot;),2),
           y = factor(rep(c(&quot;Radius&quot;,&quot;Area&quot;),each=5), levels = c(&quot;Radius&quot;, &quot;Area&quot;)),
           GDP= c(gdp^2/min(gdp^2), gdp/min(gdp))) %&gt;%
   mutate(Country = reorder(Country, GDP))
gdp_data %&gt;%
  ggplot(aes(Country, y, size = GDP)) +
  geom_point(show.legend = FALSE, color = &quot;blue&quot;) +
  scale_size(range = c(2,25)) +
  coord_flip() +
  ylab(&quot;&quot;) + xlab(&quot;&quot;) # identical to labs(y = &quot;&quot;, x = &quot;&quot;)</code></pre>
<p><img src="/content/04-content_files/figure-html/area-not-radius-1.png" width="672" /></p>
<p>Not surprisingly, <strong>ggplot2</strong> defaults to using area rather than
radius. Of course, in this case, we really should not be using area at all since we can use position and length:</p>
<pre class="r"><code>gdp_data %&gt;%
  filter(y == &quot;Area&quot;) %&gt;%
  ggplot(aes(Country, GDP)) +
  geom_bar(stat = &quot;identity&quot;, width = 0.5) +
  labs(y = &quot;GDP in trillions of US dollars&quot;)</code></pre>
<p><img src="/content/04-content_files/figure-html/barplot-better-than-area-1.png" width="50%" /></p>
</div>
<div id="order-categories-by-a-meaningful-value" class="section level3">
<h3>Order categories by a meaningful value</h3>
<p>When one of the axes is used to show categories, as is done in barplots, the default <strong>ggplot2</strong> behavior is to order the categories alphabetically when they are defined by character strings. If they are defined by factors, they are ordered by the factor levels. We rarely want to use alphabetical order. Instead, we should order by a meaningful quantity. In all the cases above, the barplots were ordered by the values being displayed. The exception was the graph showing barplots comparing browsers. In this case, we kept the order the same across the barplots to ease the comparison. Specifically, instead of ordering the browsers separately in the two years, we ordered both years by the average value of 2000 and 2015.</p>
<p>We previously learned how to use the <code>reorder</code> function, which helps us achieve this goal.
To appreciate how the right order can help convey a message, suppose we want to create a plot to compare the murder rate across states. We are particularly interested in the most dangerous and safest states. Note the difference when we order alphabetically (the default) versus when we order by the actual rate:</p>
<pre class="r"><code>data(murders)
p1 &lt;- murders %&gt;% mutate(murder_rate = total / population * 100000) %&gt;%
  ggplot(aes(x = state, y = murder_rate)) +
  geom_bar(stat=&quot;identity&quot;) +
  coord_flip() +
  theme(axis.text.y = element_text(size = 8))  +
  xlab(&quot;&quot;)

p2 &lt;- murders %&gt;% mutate(murder_rate = total / population * 100000) %&gt;%
  mutate(state = reorder(state, murder_rate)) %&gt;% # here&#39;s the magic!
  ggplot(aes(x = state, y = murder_rate)) +
  geom_bar(stat=&quot;identity&quot;) +
  coord_flip() +
  theme(axis.text.y = element_text(size = 8))  +
  xlab(&quot;&quot;)

grid.arrange(p1, p2, ncol = 2) # we&#39;ll cover this later</code></pre>
<p><img src="/content/04-content_files/figure-html/do-not-order-alphabetically-1.png" width="672" /></p>
<p>We can make the second plot like this:</p>
<pre class="r"><code>data(murders)
murders %&gt;% mutate(murder_rate = total / population * 100000) %&gt;%
  mutate(state = reorder(state, murder_rate)) %&gt;%
  ggplot(aes(state, murder_rate)) +
  geom_bar(stat=&quot;identity&quot;) +
  coord_flip() +
  theme(axis.text.y = element_text(size = 6)) +
  xlab(&quot;&quot;)</code></pre>
<p>The <code>reorder</code> function lets us reorder groups as well. Earlier we saw an example related to income distributions across regions. Here are the two versions plotted against each other:</p>
<p><img src="/content/04-content_files/figure-html/reorder-boxplot-example-1.png" width="100%" /></p>
<p>The first orders the regions alphabetically, while the second orders them by the group’s median.</p>
</div>
<div id="show-the-data" class="section level2">
<h2>Show the data</h2>
<p>We have focused on displaying single quantities across categories. We now shift our attention to displaying data, with a focus on comparing groups.</p>
<p>To motivate our first principle, “show the data”, we go back to our artificial example of describing heights to a person who is unaware of some basic facts about the population of interest (and is otherwise unsophisticated). This time let’s assume that this person is interested in the difference in heights between males and females. A commonly seen plot used for comparisons between groups, popularized by software such as Microsoft Excel, is the dynamite plot, which shows the average and standard errors.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a> The plot looks like this:</p>
<p><img src="/content/04-content_files/figure-html/show-data-1-1.png" width="672" /></p>
<p>The average of each group is represented by the top of each bar and the antennae extend out from the average to the average plus two standard errors. If all ET receives is this plot, he will have little information on what to expect if he meets a group of human males and females. The bars go to 0: does this mean there are tiny humans measuring less than one foot? Are all males taller than the tallest females? Is there a range of heights? ET can’t answer these questions since we have provided almost no information on the height distribution.</p>
<p>This brings us to our first principle: show the data. This simple <strong>ggplot2</strong> code already generates a more informative plot than the barplot by simply showing all the data points:</p>
<pre class="r"><code>heights %&gt;%
  ggplot(aes(sex, height)) +
  geom_point()</code></pre>
<p><img src="/content/04-content_files/figure-html/show-data-2-1.png" width="672" /></p>
<p>For example, this plot gives us an idea of the range of the data. However, this plot has limitations as well, since we can’t really see all the 238 and 812 points plotted for females and males, respectively, and many points are plotted on top of each other. As we have previously described, visualizing the distribution is much more informative. But before doing this, we point out two ways we can improve a plot showing all the points.</p>
<p>The first is to add <em>jitter</em>, which adds a small random shift to each point. In this case, adding horizontal jitter does not alter the interpretation, since the point heights do not change, but we minimize the number of points that fall on top of each other and, therefore, get a better visual sense of how the data is distributed. A second improvement comes from using <em>alpha blending</em>: making the points somewhat transparent. The more points fall on top of each other, the darker the plot, which also helps us get a sense of how the points are distributed. Here is the same plot with jitter and alpha blending:</p>
<pre class="r"><code>heights %&gt;%
  ggplot(aes(sex, height)) +
  geom_jitter(width = 0.1, alpha = 0.2)</code></pre>
<p><img src="/content/04-content_files/figure-html/show-points-with-jitter-1.png" width="672" /></p>
<p>Now we start getting a sense that, on average, males are taller than females. We also note dark horizontal bands of points, demonstrating that many report values that are rounded to the nearest integer.</p>
</div>
<div id="faceting" class="section level2">
<h2>Faceting</h2>
<p>Looking at the previous plot, it’s easy to tell that males tend to be taller than females. Before, we showed how we can plot two distributions over each other using an aesthetic mapping. Something like this:</p>
<pre class="r"><code>heights %&gt;%
  ggplot(aes(x = height, fill = sex)) +
  geom_histogram(alpha = .5, show.legend = TRUE) +
  labs(fill = &#39;Sex&#39;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="/content/04-content_files/figure-html/unnamed-chunk-9-1.png" width="672" />
Sometimes, putting the plots on top of each other, even with a well-chosen alpha, does not clearly communicate the differences in the distribution. When we want to compare side-by-side, we will often use <strong>facets</strong>. Facets are a bit like supercharged aesthetic mapping because they let us separate plots based on categorical variables, but instead of putting them together, we can have side-by-side plots.</p>
<p>Two functions in <code>ggplot</code> give facets: <code>facet_wrap</code> and <code>facet_grid</code>. We’ll use <code>facet_grid</code> as this is a little more powerful.</p>
<p>Facets are added as an additional layer like this: <code>+ facet_grid(. ~ sex)</code>. Inside the function, we have a “formula” that is written without quotes (which is unusual for R). Since <code>facet_grid</code> takes a “formula”, all we have to do to facet is decide how we want to lay out our plots. If we want each of the faceting groups to lie along the vertical axis, we put the variable on which we want to facet before the “~”, and after the “~” we simply put a period. If we want the groups to lie along the horizontal axis, we put the variable after the “~” and the period before. In the example, we’ll separate the histogram by drawing them side by side along the horizontal axis.</p>
<pre class="r"><code>heights %&gt;%
  ggplot(aes(x = height)) +
  geom_histogram(binwidth = 1, color=&quot;black&quot;) +
  facet_grid(.~sex)</code></pre>
<p><img src="/content/04-content_files/figure-html/unnamed-chunk-10-1.png" width="672" />
This would be the result if we took the females, plotted the histogram, then took the males, made another histogram, and then put them side by side. But we do it in one command by adding <code>+facet_grid(...)</code></p>
<div id="use-common-axes-with-facets" class="section level3">
<h3>Use common axes with facets</h3>
<p>Since we have plots side-by-side, they can have different scales along the x-axis (or along the y-axis if we were stacking with <code>sex ~ .</code>). We want to be careful here - if we don’t have matching scales on these axes, then it’ll be really hard to visually see differences in the distribution.</p>
<p>As an example of what not to do, and to show that we can use the <code>scales</code> argument in <code>facet_grid</code>, we can allow the x-axis to freely scale between the plots. This makes it hard to tell that males are, on average, taller because the average male height, despite being larger than the average female height (70 vs. 65 or so) <em>falls in the same location within the plot box</em>. Note that 80 is the extreme edge for the left plot, but not in the right plot.</p>
<pre class="r"><code>heights %&gt;%
  ggplot(aes(height)) +
  geom_histogram(binwidth = 1, color=&quot;black&quot;) +
  facet_grid(. ~ sex, scales = &quot;free_x&quot;)</code></pre>
<p><img src="/content/04-content_files/figure-html/common-axes-histograms-wrong-1.png" width="672" /></p>
</div>
<div id="align-plots-vertically-to-see-horizontal-changes-and-horizontally-to-see-vertical-changes" class="section level3">
<h3>Align plots vertically to see horizontal changes and horizontally to see vertical changes</h3>
<p>In these histograms, the visual cue related to decreases or increases in height are shifts to the left or right, respectively: horizontal changes. Aligning the plots vertically helps us see this change when the axes are fixed:</p>
<pre class="r"><code>heights %&gt;%
  ggplot(aes(height)) +
  geom_histogram(binwidth = 1, color=&quot;black&quot;) +
  facet_grid(. ~ sex)</code></pre>
<p><img src="/content/04-content_files/figure-html/common-axes-histograms-right-2-1.png" width="672" /></p>
<pre class="r"><code>p2 &lt;- heights %&gt;%
  ggplot(aes(height)) +
  geom_histogram(binwidth = 1, color=&quot;black&quot;) +
  facet_grid(sex~.)
p2</code></pre>
<p><img src="/content/04-content_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>This plot makes it much easier to notice that men’s heights are, on average, higher.</p>
<p>The sample size of females is smaller than of males – that is, we have more males in the data. Try <code>table(heights$sex)</code> to see this. It’s also clear from the above plot because the height of the bars on the y-axis (<code>count</code>) are smaller for females. If we are interested in the distribution within our sample, this is useful. If we’re interested in the distribution of females vs. the distribution of males, we might want to re-scale the y-axis.</p>
<pre class="r"><code>p2 &lt;- heights %&gt;%
  ggplot(aes(height)) +
  geom_histogram(binwidth = 1, color=&quot;black&quot;) +
  facet_grid(sex~., scales = &#39;free_y&#39;)
p2</code></pre>
<p><img src="/content/04-content_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>We still have <code>count</code> on the y-axis, so we didn’t switch to density (though it would look the same). Instead, we rescaled the y-axis, which gives us a different perspective but still contains the count information.</p>
<p>If we want the more compact summary provided by boxplots, we then align them horizontally since, by default, boxplots move up and down with changes in height. Following our <em>show the data</em> principle, we then overlay all the data points:</p>
<pre class="r"><code>p3 &lt;- heights %&gt;%
  ggplot(aes(sex, height)) +
  geom_boxplot(coef=3) +
  geom_jitter(width = 0.1, alpha = 0.2) +
  ylab(&quot;Height in inches&quot;)</code></pre>
<p>Now contrast and compare these three plots, based on exactly the same data:</p>
<p><img src="/content/04-content_files/figure-html/show-the-data-comparison-1.png" width="100%" /></p>
<p>Notice how much more we learn from the two plots on the right. Barplots are useful for showing one number, but not very useful when we want to describe distributions.</p>
</div>
<div id="facet-grids" class="section level3">
<h3>Facet grids</h3>
<p>As the name implies, <code>facet_grid</code> can make more than just side-by-plots. If we specify variables on boths sides of the “~”, we get a grid of plots.</p>
<pre class="r"><code>gapminder::gapminder %&gt;%
  filter(year %in% c(1952,1972, 1992, 2002)) %&gt;%
  filter(continent != &#39;Oceania&#39;) %&gt;%
  ggplot(aes(x = lifeExp)) +
  geom_density() +
  facet_grid(continent ~ year)</code></pre>
<p><img src="/content/04-content_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>This makes it easy to read the life expectancy distribution over time (left-to-right) and across continents (up-and-down). It makes it easy to see that Africa has spread it’s life expectancy distribution (some improved, some didn’t), while Europe has become more clustered at the top end over time. Faceting in a grid is very helpful when you have a time dimension.</p>
</div>
<div id="visual-cues-to-be-compared-should-be-adjacent-continued" class="section level3">
<h3>Visual cues to be compared should be adjacent, continued</h3>
<p>For each continent, let’s compare income in 1970 versus 2010. When comparing income data across regions between 1970 and 2010, we made a figure similar to the one below, but this time we investigate continents rather than regions.</p>
<p>Note that there are two <code>gapminder</code> datasets, one in <code>dslabs</code> and one in the <code>gapminder</code> package. The <code>dslabs</code> version has more data, so I will switch to that here by using <code>dslabs::gapminder</code> as our data.</p>
<pre class="r"><code>dslabs::gapminder %&gt;%
  filter(year %in% c(1970, 2010) &amp; !is.na(gdp)) %&gt;%
  mutate(dollars_per_day = gdp/population/365) %&gt;%
  mutate(labels = paste(year, continent)) %&gt;%  # creating text labels
  ggplot(aes(x = labels, y = dollars_per_day)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.25)) +
  scale_y_continuous(trans = &quot;log2&quot;) +
  ylab(&quot;Income in dollars per day&quot;)</code></pre>
<p><img src="/content/04-content_files/figure-html/boxplots-not-adjacent-1.png" width="672" /></p>
<p>The default in <strong>ggplot2</strong> is to order labels alphabetically so the labels with 1970 come before the labels with 2010, making the comparisons challenging because a continent’s distribution in 1970 is visually far from its distribution in 2010. It is much easier to make the comparison between 1970 and 2010 for each continent when the boxplots for that continent are next to each other:</p>
<pre class="r"><code>dslabs::gapminder %&gt;%
  filter(year %in% c(1970, 2010) &amp; !is.na(gdp)) %&gt;%
  mutate(dollars_per_day = gdp/population/365) %&gt;%
  mutate(labels = paste(continent, year)) %&gt;%
  ggplot(aes(labels, dollars_per_day)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = .25)) +
  scale_y_continuous(trans = &quot;log2&quot;) +
  ylab(&quot;Income in dollars per day&quot;)</code></pre>
<p><img src="/content/04-content_files/figure-html/boxplot-adjacent-comps-1.png" width="672" /></p>
</div>
<div id="use-color" class="section level3">
<h3>Use color</h3>
<p>The comparison becomes even easier to make if we use color to denote the two things we want to compare. Now we do not have to make the labels column and can just use <code>continent</code> on the x-axis:</p>
<p><img src="/content/04-content_files/figure-html/boxplot-adjacent-comps-with-color-1.png" width="672" /></p>
</div>
</div>
<div id="think-of-the-color-blind" class="section level2">
<h2>Think of the color blind</h2>
<p>About 10% of the population is color blind. Unfortunately, the default colors used in <strong>ggplot2</strong> are not optimal for this group. However, <strong>ggplot2</strong> does make it easy to change the color palette used in the plots. An example of how we can use a color blind friendly palette is described here: <a href="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/#a-colorblind-friendly-palette">http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/#a-colorblind-friendly-palette</a>:</p>
<pre class="r"><code>color_blind_friendly_cols &lt;-
  c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;, &quot;#009E73&quot;,
    &quot;#F0E442&quot;, &quot;#0072B2&quot;, &quot;#D55E00&quot;, &quot;#CC79A7&quot;)</code></pre>
<p>Here are the colors
<img src="/content/04-content_files/figure-html/color-blind-friendly-colors-1.png" width="672" /></p>
<p>From <a href="http://www.pnas.org/content/pnas/early/2017/01/24/1617948114.full.pdf">Seafood Prices Reveal Impacts of a Major Ecological Disturbance</a>:</p>
<p><img src="/content/04-content_files/Colorblind_example.png" /></p>
<p>There are several resources that can help you select colors, for example this one: <a href="http://bconnelly.net/2013/10/creating-colorblind-friendly-figures/">http://bconnelly.net/2013/10/creating-colorblind-friendly-figures/</a>.</p>
<div id="using-a-discrete-color-palette" class="section level3">
<h3>Using a discrete color palette</h3>
<p>If you’re simply trying to differentiate between groups by using color, there are many ways of changing your color palette in <code>ggplot</code>. Most use <code>scale_fill_discrete</code> or <code>scale_color_discrete</code> (depending on the aesthetic for which you’re setting the color).</p>
<p>The easiest way of getting good-looking (e.g. non-default) colors is the <code>scale_fill_viridis_d</code> function, which “inherits” (takes the place of and has the properties of) <code>scale_fill_discrete</code>. Viridis has four color palettes and each is designed to be used to maximize the differentiation between colors.</p>
<p>We will subset our <code>dslabs::gapminder</code> dataset to five different years and take a look at what Viridis colors can do across those five:</p>
<pre class="r"><code>gp = dslabs::gapminder %&gt;%
filter(year == 1990 | year == 1995 | year==2000 |  year == 2005 | year==2010 ) %&gt;%
ggplot(aes(x = continent, y = gdp/population, fill = as.factor(year)))  + coord_flip()

gp + geom_boxplot()  + labs(title = &#39;Default&#39;)</code></pre>
<p><img src="/content/04-content_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>The default uses five different colors plucked seemingly at random. They are actually drawn from a palette of default ggplot colors.</p>
<p>Let’s try Viridis</p>
<pre class="r"><code>gp = dslabs::gapminder %&gt;%
filter(year == 1990 | year == 1995 | year==2000 |  year == 2005 | year==2010 ) %&gt;%
ggplot(aes(x = continent, y = gdp/population, fill = as.factor(year)))  + coord_flip() + labs(fill = &#39;Year&#39;)

viridis_a = gp + geom_boxplot()  + labs(title = &#39;Viridis A&#39;) + scale_fill_viridis_d(option = &#39;A&#39;)
viridis_b = gp + geom_boxplot()  + labs(title = &#39;Viridis B&#39;) + scale_fill_viridis_d(option = &#39;B&#39;)
viridis_c = gp + geom_boxplot()  + labs(title = &#39;Viridis C&#39;) + scale_fill_viridis_d(option = &#39;C&#39;)
viridis_d = gp + geom_boxplot()  + labs(title = &#39;Viridis D&#39;) + scale_fill_viridis_d(option = &#39;D&#39;)

grid.arrange(viridis_a, viridis_b, viridis_c, viridis_d)</code></pre>
<p><img src="/content/04-content_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Viridis uses a better palette of colors that, though distinct, have some cohesiveness to them.</p>
<p>We can also use a custom palette, like the colorblind palette from before. If the palette has more entries than we have (N) distinct categories, R reverts to the default.</p>
<pre class="r"><code>gp = dslabs::gapminder %&gt;%
filter(year == 1990 | year == 1995 | year==2000 |  year == 2005 | year==2010 ) %&gt;%
ggplot(aes(x = continent, y = gdp/population, fill = as.factor(year)))  + coord_flip() + labs(fill = &#39;Year&#39;)

custom_a = gp + geom_boxplot()  + labs(title = &#39;Viridis A&#39;) + scale_fill_discrete(type = color_blind_friendly_cols)
custom_b = gp + geom_boxplot()  + labs(title = &#39;Viridis A&#39;) + scale_fill_discrete(type = color_blind_friendly_cols[1:3])

grid.arrange(custom_a, custom_b)</code></pre>
<p><img src="/content/04-content_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>In the lower plot, we only give it a length-3 vector of colors, and it needs 5, so it returns to default.</p>
</div>
<div id="using-a-continuous-color-palette" class="section level3">
<h3>Using a continuous color palette</h3>
<p>We may often want to use the color to indicate a numeric value instead of simply using it to delineate groupings. When this is the case, the <code>fill</code> or <code>color</code> aesthetic is set to a continuous value. For instance, if one were to plot election results by precinct, we may represent precincts with heavy Republican support as dark red, swing districts as purple or white, and Democratic districts as blue. The intensity of red/blue indicates how heavily slanted votes in that precinct were in the election. This is known as a <em>color ramp</em>.</p>
<p>Lets plot one country’s GDP by year, but have the color indicate the life expectancy:</p>
<pre class="r"><code>dslabs::gapminder %&gt;%
  filter(country==&#39;Romania&#39; &amp; year&gt;1980) %&gt;%
  ggplot(aes(x = year, y = gdp/population, color = life_expectancy)) +
  scale_fill_continuous() +
  geom_point(size = 5) +
  labs(x = &#39;Year&#39;, y = &#39;GDP Per Capita&#39;, fill = &#39;Life Expectancy&#39;)</code></pre>
<p><img src="/content/04-content_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>We can see that GDP per capita went up, then down in 1989 (fall of the Soviet Union), then up after that. The color ramp tells us that life expectancy reached 75 years near the end, and it certainly improved in the post-2000 era.</p>
<p>We can set some of the points on the ramp manually - here, the ramp starts at dark blue and ends at light blue, but what if we wanted to start at red, and at blue, and cross white in the middle? Easy! We use <code>scale_color_gradient2</code> and specify the colors for low, mid, and high, and specify the midpoint at 72.5 years.</p>
<pre class="r"><code>dslabs::gapminder %&gt;%
  filter(country==&#39;Romania&#39; &amp; year&gt;1980) %&gt;%
  ggplot(aes(x = year, y = gdp/population, color = life_expectancy)) +
  scale_color_gradient2(low = &#39;red&#39;, mid = &#39;white&#39;, high = &#39;blue&#39;, midpoint = 72.5) +
  geom_point(size = 5) +
  labs(x = &#39;Year&#39;, y = &#39;GDP Per Capita&#39;, fill = &#39;Life Expectancy&#39;)</code></pre>
<p><img src="/content/04-content_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>The midpoint specification is extra useful when there is a threshold (like 50% of the vote) that indicates a different qualitative outcome.</p>
<p>The gradient2 method does not always work with the colorblind discrete palette - the colors interpolated may be in the range in which colorblindness tends to be a problem:</p>
<pre class="r"><code>dslabs::gapminder %&gt;%
  filter(country==&#39;Romania&#39; &amp; year&gt;1980) %&gt;%
  ggplot(aes(x = year, y = gdp/population, color = life_expectancy)) +
  scale_color_gradient2(low = color_blind_friendly_cols[3], mid = color_blind_friendly_cols[4], high = color_blind_friendly_cols[5], midpoint = 72.5) +
  geom_point(size = 5) +
  labs(x = &#39;Year&#39;, y = &#39;GDP Per Capita&#39;, fill = &#39;Life Expectancy&#39;)</code></pre>
<p><img src="/content/04-content_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
</div>
<div id="gridextra-and-grid.arrange" class="section level2">
<h2>gridExtra and <code>grid.arrange</code></h2>
<p>The <code>gridExtra</code> package has been used a few times in this lesson to combine plots using the <code>grid.arrange</code> function. The use is pretty intuitive - you save your plots as objects <code>plot1 &lt;- ggplot(data, aes(x = var1))</code> and <code>plot2 &lt;- ggplot(data, aes(x = var2))</code>, and then use <code>grid.arrange(plot1, plot2)</code> to combine. The function will align as best it can, and there are more advanced <a href="https://cran.r-project.org/web/packages/gridExtra/vignettes/arrangeGrob.html">grob-based functions</a> that can adjust and align axes between plots, but we won’t get into them. If we want to set the layout, we can specify <code>nrow</code> and <code>ncol</code> to set the rows and columns.</p>
<p>The very-useful <code>patchwork</code> package is quickly replacing <code>grid.arrange</code> and provides more flexibility.</p>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p><a href="http://kbroman.org/" class="uri">http://kbroman.org/</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><a href="https://www.biostat.wisc.edu/~kbroman/presentations/graphs2017.pdf" class="uri">https://www.biostat.wisc.edu/~kbroman/presentations/graphs2017.pdf</a><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p><a href="https://github.com/kbroman/Talk_Graphs" class="uri">https://github.com/kbroman/Talk_Graphs</a><a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p><a href="http://paldhous.github.io/ucb/2016/dataviz/index.html" class="uri">http://paldhous.github.io/ucb/2016/dataviz/index.html</a><a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p><a href="https://projecteuclid.org/download/pdf_1/euclid.ss/1177010488" class="uri">https://projecteuclid.org/download/pdf_1/euclid.ss/1177010488</a><a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p><a href="http://mediamatters.org/blog/2013/04/05/fox-news-newest-dishonest-chart-immigration-enf/193507" class="uri">http://mediamatters.org/blog/2013/04/05/fox-news-newest-dishonest-chart-immigration-enf/193507</a><a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p><a href="http://flowingdata.com/2012/08/06/fox-news-continues-charting-excellence/" class="uri">http://flowingdata.com/2012/08/06/fox-news-continues-charting-excellence/</a><a href="#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p><a href="https://www.pakistantoday.com.pk/2018/05/18/whats-at-stake-in-venezuelan-presidential-vote" class="uri">https://www.pakistantoday.com.pk/2018/05/18/whats-at-stake-in-venezuelan-presidential-vote</a><a href="#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p><a href="https://www.youtube.com/watch?v=kl2g40GoRxg" class="uri">https://www.youtube.com/watch?v=kl2g40GoRxg</a><a href="#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>If you’re unfamiliar, standard errors are defined later in the course—do not confuse them with the standard deviation of the data.<a href="#fnref10" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

                    </div>

                    



                    
                </div>

                <div class="body-footer">
                    <p>Last updated on November 2, 2021</p>

                    


                    

                </div>

            </article>

            <footer>
    <hr>

    <div class="row course-info">
        <div class="col-md-7">
            <p>
                <strong>SSC 442: Data Analytics (Fall Semester 2021)</strong><br>

                <a href="https://www.msu.edu" target="_blank" rel="noopener">Michigan State University</a> &emsp;&emsp;
                <a href="https://socialscience.msu.edu/" target="_blank" rel="noopener">College of Social Science</a>
            </p>

            <p>
                <a href="https://www.benbushong.com" target="_blank" rel="noopener"><i class="fas fa-user"></i>
                    Prof. Ben Bushong</a> &emsp;&emsp;
                <a href="mailto:bbushong@msu.edu"><i class="fas fa-envelope"></i>
                    bbushong@msu.edu</a>
            </p>

            <p>
                <i class="far fa-calendar-alt"></i> Tuesday and Thursday &emsp;&emsp;
                <i class="far fa-clock"></i> 12:40pm - 2:00pm 
                
            </p>
        </div>

        <div class="col-md-5 credits">
            <p>All content licensed under a <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="noopener">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.</p>
            
            <p>Content <i class="fab fa-creative-commons"></i> 2021 <a href="https://www.benbushong.com" target="_blank" rel="noopener"></a></p>
        
            <p>This site created with the <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> in <a href="https://bookdown.org/yihui/blogdown/" target="_blank" rel="noopener">blogdown</a> and <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a>. </p>
            
            <p><a href="https://github.com/" target="_blank" rel="noopener"><i class="fab fa-github"></i> View the source at GitHub.</a></p>
        </div>
    </div>
</footer>


        </main>
    </div>
</div>

        

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    

    
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academic.min.6f7ce8be710290b8c431bbc97f405d15.js"></script>

    



    
    

    
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>

</html>
